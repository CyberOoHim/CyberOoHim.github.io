---
title: (試驗版，閣咧改良）Taigi-English Quiz Game
version: v0c
permalink: /pages/taigi_english_quiz_game.html
---
<!--
    Copyright (C) [year] [name of copyright owner]

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taigi-English Word Game</title>
    <style>
        /* CSS (no changes) */
        body {
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: #f8f8f8;
            /* Base font size for the entire game */
            font-size: 28px; /* Set the base font size here */
        }

        /* Container for fixed width */
        #container-wrapper {
            width: 600px; /* Set your desired fixed width here */
            max-width: 95%; /* Adjust responsive maximum width percentage */
            margin: 0 auto; /* Center the container horizontally */
        }

        #container {
            background-color: #fff;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
            /* Title font size (adjust as needed) */
            font-size: 1.3em;  /* 1.5 times the base font size */
        }

        #word {
            margin-bottom: 20px;
            color: #2196F3;
            /* Question font size and weight */
            font-size: 1.3em; /* Same as the base font size */
            font-weight: bold; /* Make question bold */
        }

        #options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
            text-align: left;
            align-items: center;
            width: 45%;
        }

        .option-container {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            border-radius: 5px;
            background-color: #e0e0e0;
            transition: background-color 0.3s;
            width: 100%;
            /* Option font size (adjust as needed) */
            font-size: 0.9em; /* Slightly smaller than base font size */
        }

        .option-container:hover {
            background-color: #d0d0d0;
        }

        .option-container input[type="radio"] {
            margin-right: 10px;
        }

        #submit-button,
        #reset-button,
        #next-button {
            color: white;
            border: none;
            padding: 15px 25px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 10px;
            /* Button font size (adjust as needed) */
            font-size: 0.8em; /* Slightly smaller than base font size */
        }

        /* Submit button styles */
        #submit-button {
            background-color: #4CAF50;
            margin-right: 20px;
        }

        #submit-button:hover {
            background-color: #367c39;
        }

        /* Reset button styles */
        #reset-button {
            background-color: #f44336; /* Red color */
        }

        #reset-button:hover {
            background-color: #da190b; /* Darker red on hover */
        }

        /* Next button styles */
        #next-button {
            background-color: #2196F3; /* Blue color */
            display: none; /* Initially hidden */
        }

        #next-button:hover {
            background-color: #0d8aee; /* Darker blue on hover */
        }

        #result {
            margin-top: 20px;
            font-weight: bold;
            /* Result text font size (adjust as needed) */
            font-size: 0.9em; /* Slightly smaller than base font size */
        }

        .correct {
            color: green;
        }

        .incorrect {
            color: red;
        }

        #scoreRow {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin-bottom: 10px;
            width: 50%;
        }

        #scoreLabel,
        #incorrectScoreLabel {
            font-weight: bold;
            /* Score label font size (adjust as needed) */
            font-size: 0.9em; /* Slightly smaller than base font size */
        }

        #score,
        #incorrectScore {
            margin-left: 10px;
            /* Score display font size (adjust as needed) */
            font-size: 0.9em; /* Slightly smaller than base font size */
        }

        #incorrectScore {
            color: red;
        }

        #button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }

        #bulletinRow {
            margin-bottom: 10px;
            /* Bulletin font size */
            font-size: 0.9em; /* Same as score label font size */
        }

        #bulletin {
            font-weight: bold;
        }

        /* Checkbox styles */
        #chineseCheckboxContainer {
            margin-bottom: 10px; /* Add some spacing */
            font-size: 0.8em; /* Match button font size */
            margin-top: 20px; /* Add some top margin */
        }
    </style>
</head>
<body>
    <div id="container-wrapper">
        <div id="container">
            <h1 id="gameTitle"></h1>
            <div id="scoreRow">
                <div>
                    <span id="scoreLabel"></span>
                    <span id="score">0</span>
                </div>
                <div>
                    <span id="incorrectScoreLabel"></span>
                    <span id="incorrectScore">0</span>
                </div>
            </div>
            <div id="bulletinRow">
                <div id="bulletin"></div>
            </div>
            <div id="word"></div>
            <div id="options"></div>
            <div id="button-container">
                <button id="submit-button"></button>
                <button id="reset-button"></button>
                <button id="next-button"></button>
            </div>
            <div id="result"></div>
            <div id="chineseCheckboxContainer">
                <input type="checkbox" id="chineseCheckbox">
                <label for="chineseCheckbox">Show Chinese</label>
            </div>
        </div>
    </div>
<script>
    // JavaScript
    // Configuration: Path to the Taigi-English dictionary JSON
// Define a condition for switching paths
const useLocalPath = true; // Set to true to use the external path

// Use the condition to determine the dictionary path
const dictionaryPath = useLocalPath 
    ? '/assets/json/taigi_223_of_700_en_cn_v0b.json'
    : 'taigi_223_of_700_en_cn_v0b.json';
    
    const uiText = {
        gameTitle: "台-英 奕字",
        scoreLabel: "着分:",
        incorrectScoreLabel: "毋着:",
        initialBulletin: "逐家來𨑨迌--o͘h!",
        submitButton: "交答案",
        resetButton: "重奕",
        nextButton: "後一字",
        correct: [
            "着--ah!",
            "媠 ŏ͘!",
            "Gâu--neh👍",
            "讃--lah!",
            "Pho̍k-á 聲催--loeh👏!"
        ],
        incorrectPrefix: "毋着! ",
        correctAnswerMiddle: "應該是 ",
        selectAnswer: "愛揀一項👆",
        consecutive3: "連紲着三改! 讃 ŏ͘🎉",
        consecutive6: "相連紲着六改! 媠--lah👏",
        consecutive10: "相連紲着十改! 有夠 gâu💪",
        incorrect: [
            "Oah! 咱閣試--一改。",
            "Chhui--loeh! 後一擺就着--lo͘h。",
            "莫失志! 繼續拼--loeh💪",
            "免煩惱! 差一屑屑仔爾爾。",
            "無要緊! 閣試看覓😁"
        ],
        selectOne: "揀--一項。",
        incorrectRetry: "閣 thang 幾改: ",
        incorrectHint: "提示: "
    };
    
    // Get elements (no changes)
    const wordElement = document.getElementById('word');
    const optionsElement = document.getElementById('options');
    const resultElement = document.getElementById('result');
    const scoreElement = document.getElementById('score');
    const incorrectScoreElement = document.getElementById('incorrectScore');
    const bulletinElement = document.getElementById('bulletin');
    const submitButton = document.getElementById('submit-button');
    const resetButton = document.getElementById('reset-button');
    const nextButton = document.getElementById('next-button');
    // Get the checkbox element
    const chineseCheckbox = document.getElementById('chineseCheckbox');

    // Initialize variables (no changes)
    let currentWord = '';
    let options = [];
    let score = 0;
    let incorrectScore = 0;
    let consecutiveCorrectAnswers = 0;
    let questionCounter = 0;
    let selectedOption = null;
    let retries = 3;
    let correctlyAnsweredWords = new Set();
    let wordData = [];
    let showChinese = false; // Initial state for Chinese display

    // Set initial UI text (no changes)
    document.getElementById('gameTitle').textContent = uiText.gameTitle;
    document.getElementById('scoreLabel').textContent = uiText.scoreLabel;
    document.getElementById('incorrectScoreLabel').textContent = uiText.incorrectScoreLabel;
    document.getElementById('incorrectScore').textContent = incorrectScore;
    bulletinElement.textContent = uiText.initialBulletin;
    submitButton.textContent = uiText.submitButton;
    resetButton.textContent = uiText.resetButton;
    nextButton.textContent = uiText.nextButton;

    // Function to fetch the dictionary (no changes)
    async function fetchDictionary() {
        try {
        // Set Taigi-English dictionary path
            // GitHub pages
            const response = await fetch(dictionaryPath);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            wordData = await response.json();
            displayWord();
        } catch (error) {
            console.error('Error fetching dictionary:', error);
            bulletinElement.textContent = 'Failed to load dictionary.';
        }
    }

    // Function to get a random word (no changes)
    function getRandomWord() {
        return wordData[Math.floor(Math.random() * wordData.length)];
    }

    // Function to shuffle an array (no changes)
    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // Function to display a word and options (no changes from previous version)
    function displayWord() {
        resultElement.textContent = '';
        selectedOption = null;
        retries = 3;
        nextButton.style.display = 'none';
        submitButton.style.display = 'inline-block';

        // The do...while loop was removed to prevent moving to the next question

        currentWord = currentWord || getRandomWord(); // Keep the current word or get a new one if it's not set
        
        // Prevent displaying a word that has been correctly answered before
        while (correctlyAnsweredWords.has(currentWord.POJ)) {
            currentWord = getRandomWord();
        }

        wordElement.textContent = currentWord.POJ + " (" + currentWord.Hanji + ")";

        // Include Chinese (cn) with English (en) if checkbox is checked
        options = [showChinese ? currentWord.en + " (" + currentWord.cn + ")" : currentWord.en];
        while (options.length < 4) {
            const randomWord = getRandomWord();
            // Include Chinese (cn) for incorrect options as well if checkbox is checked
            const randomTranslation = showChinese ? randomWord.en + " (" + randomWord.cn + ")" : randomWord.en;
            if (!options.includes(randomTranslation)) {
                options.push(randomTranslation);
            }
        }

        options = shuffle(options);

        optionsElement.innerHTML = '';
        options.forEach((option, index) => {
            const optionContainer = document.createElement('div');
            optionContainer.classList.add('option-container');

            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.name = 'answer';
            radio.value = option; // Value is now en + cn (or just en)
            radio.id = 'option' + index;
            optionContainer.appendChild(radio);

            const label = document.createElement('label');
            label.textContent = option;
            label.htmlFor = 'option' + index;
            optionContainer.appendChild(label);

            optionsElement.appendChild(optionContainer);
        });
    }

    // Function to check the answer (modified to use fun responses from uiText and put them in the bulletin)
    function checkAnswer() {
        questionCounter++;
        selectedOption = document.querySelector('input[name="answer"]:checked');

        if (selectedOption) {
            // Extract only the English part for comparison
            const selectedEnglish = showChinese ? selectedOption.value.split(" (")[0] : selectedOption.value;

            if (selectedEnglish === currentWord.en) {
                // Correct answer
                if (!correctlyAnsweredWords.has(currentWord.POJ)) {
                    score++;
                    correctlyAnsweredWords.add(currentWord.POJ);
                }
                consecutiveCorrectAnswers++;

                // Choose a random correct response for the bulletin
                const correctResponse = uiText.correct[Math.floor(Math.random() * uiText.correct.length)];
                resultElement.textContent = ""; // Clear the result element
                resultElement.className = 'correct';

                // Bulletin logic
                if (consecutiveCorrectAnswers === 10) {
                    bulletinElement.textContent = uiText.consecutive10;
                } else if (consecutiveCorrectAnswers % 6 === 0) {
                    bulletinElement.textContent = uiText.consecutive6;
                } else if (consecutiveCorrectAnswers % 3 === 0) {
                    bulletinElement.textContent = uiText.consecutive3;
                } else {
                    bulletinElement.textContent = correctResponse; // Display the random correct response
                }

                // Update score display
                scoreElement.textContent = score;
                incorrectScoreElement.textContent = incorrectScore;

                // Display next word after a delay
                setTimeout(() => {
                    currentWord = null; // Reset currentWord to get a new word
                    displayWord();
                }, 1500);
            } else {
                // Incorrect answer
                retries--;
                if (retries === 0) {
                    consecutiveCorrectAnswers = 0;
                    incorrectScore++;

                    // Choose a random incorrect response for the bulletin
                    const incorrectResponse = uiText.incorrect[Math.floor(Math.random() * uiText.incorrect.length)];
                    resultElement.textContent = 
                        uiText.incorrectPrefix + "\"" + 
                        currentWord.POJ + " (" + currentWord.Hanji + ")\" " + 
                        uiText.correctAnswerMiddle + "\"" + 
                        (showChinese ? currentWord.en + " (" + currentWord.cn + ")" : currentWord.en) + "\".";
                    resultElement.className = 'incorrect';
                    bulletinElement.textContent = incorrectResponse; // Display the random incorrect response

                    // Update score display
                    scoreElement.textContent = score;
                    incorrectScoreElement.textContent = incorrectScore;

                    // Show next button, hide submit button
                    nextButton.style.display = 'inline-block';
                    submitButton.style.display = 'none';
                } else {
                    // Show hint after 2 retries, include Chinese in hint if checkbox is checked
                    if (retries == 1) {
                        resultElement.textContent = `${uiText.incorrectRetry} ${retries} → ${uiText.incorrectHint} ${
                            showChinese ? `${currentWord.en} (${currentWord.cn})` : currentWord.en
                        }`;
                    } else {
                        resultElement.textContent = `${uiText.incorrectRetry} ${retries}`;
                    }
                    resultElement.className = 'incorrect';
                    bulletinElement.textContent = '';
                }
            }
        } else {
            // No answer selected
            resultElement.textContent = uiText.selectAnswer;
            resultElement.className = 'incorrect';
            bulletinElement.textContent = uiText.selectOne;
        }
    }

    // Function to reset the game (no changes)
    function resetGame() {
        score = 0;
        incorrectScore = 0;
        consecutiveCorrectAnswers = 0;
        questionCounter = 0;
        retries = 3;
        scoreElement.textContent = score;
        incorrectScoreElement.textContent = incorrectScore;
        bulletinElement.textContent = uiText.initialBulletin;
        resultElement.textContent = '';
        correctlyAnsweredWords.clear();
        currentWord = null; // Reset currentWord to get a new word
        displayWord();
    }

    // Event listeners (no changes from previous version)
    submitButton.addEventListener('click', checkAnswer);
    resetButton.addEventListener('click', resetGame);
    nextButton.addEventListener('click', () => {
        currentWord = null; // Reset currentWord to get a new word
        displayWord();
    });
    // Checkbox event listener
    chineseCheckbox.addEventListener('change', () => {
        showChinese = chineseCheckbox.checked;
        displayWord(); // Re-display the word to reflect changes
    });

    // Start the game (no changes)
    fetchDictionary();
</script>
